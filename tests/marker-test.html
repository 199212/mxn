<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Mapstraction Marker Event Test - Google v3</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<script src="http://code.jquery.com/jquery-1.8.2.min.js" type="text/javascript"></script>
	<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript" charset="utf-8"></script>
	<script src="../source/mxn.js?(googlev3)" type="text/javascript"></script>
	<link rel="stylesheet" type="text/css" media="all" href="../examples/css/examples.css">
	<script type="text/javascript">

	var map;

	function click_handler(event, marker) {
		//We close alll the existing bubbles.
		map.markers.forEach(function(item, i) {
			item.closeBubble();
		});

		//We open the corresponding bubble.
		marker.openBubble();
	}
	
	function initialize() {
		map = new mxn.Mapstraction('map', 'googlev3');

		var coords = [
			new mxn.LatLonPoint(40.415756, -3.6959158),
			new mxn.LatLonPoint(40.42, -3.54)
		];

		var markers = [];

		map.setCenterAndZoom(coords[0], 10);

		for (var i=0; i<coords.length; i++) {
			markers[i] = new mxn.Marker(coords[i]);
			markers[i].setInfoBubble('marker ' + (i + 1));
			markers[i].setDefaultHandler(false);
			markers[i].click.addHandler(click_handler);
			map.addMarker(markers[i]);
		}
	}
	
	function logInfo(msg) {
		logMessage ('info', msg);
	}
	
	function logEvent(msg) {
		logMessage ('events', msg);
	}

	function logMessage(element, msg) {
		var	display = document.getElementById(element);
		
		display.innerHTML += "\n" + msg;
		display.scrollTop = display.scrollHeight - display.clientHeight;
		return false;
	}
	
	$(document).ready(function() {
		initialize();
	});
	</script>
</head>
<body>
</body>
	<div id="map"></div>
	<div id="container">
		<!--
		<div class="box">
			<h2>Examples</h2>
			<textarea id="examples" placeholder="Map Event Test"></textarea>
			</div>
		</div>
		-->
		<div class="box">
			<h2>Info</h2>
			<textarea id="info" placeholder="API Info"></textarea>
		</div>
		<div class="box">
			<h2>Events</h2>
			<textarea id="events" placeholder="API Events"></textarea>
		</div>
	</div>
</html>